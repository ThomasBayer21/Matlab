<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MATLAB Visualisierung - Interaktive Plots</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            min-height: 100vh;
        }
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .header a {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s;
        }
        .header a:hover {
            opacity: 1;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: -1px;
            flex-wrap: wrap;
        }
        .tab-button {
            padding: 12px 24px 18px 24px;
            background: rgba(255,255,255,0.3);
            border: none;
            border-radius: 8px 8px 0 0;
            color: white;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }
        .tab-button:hover {
            background: rgba(255,255,255,0.5);
        }
        .tab-button.active {
            background: white;
            color: #1abc9c;
        }
        .tab-button:first-child {
            border-radius: 12px 8px 0 0;
        }
        .content {
            background: white;
            border-radius: 0 12px 12px 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        h2 {
            color: #1abc9c;
            margin-top: 0;
        }
        .interactive-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: flex-end;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .control-group label {
            font-size: 0.9em;
            color: #555;
            font-weight: 600;
        }
        input[type="number"], input[type="text"], input[type="color"], select {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 1em;
        }
        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            margin-right: 5px;
            vertical-align: middle;
        }
        button {
            padding: 10px 20px;
            background: #1abc9c;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s;
        }
        button:hover {
            background: #16a085;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .code-block .comment {
            color: #75715e;
        }
        .code-block .string {
            color: #e6db74;
        }
        .code-block .function {
            color: #66d9ef;
        }
        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }
        .plot-types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .plot-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #ddd;
            transition: all 0.3s;
            cursor: pointer;
        }
        .plot-card:hover {
            border-color: #1abc9c;
            box-shadow: 0 4px 12px rgba(26, 188, 156, 0.2);
        }
        .plot-card h3 {
            margin-top: 0;
            color: #1abc9c;
        }
        .plot-card.active {
            border-color: #1abc9c;
            background: #f0fdf4;
        }
        .mini-chart {
            height: 150px;
            margin: 10px 0;
        }
        .color-picker-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .axes-config {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>MATLAB Visualisierung & Plots</h1>
        <p><a href="../index.html">← Zurück zur Übersicht</a></p>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('grundlagen')">Plot-Grundlagen</button>
            <button class="tab-button" onclick="showTab('plottypen')">Plot-Typen</button>
            <button class="tab-button" onclick="showTab('achsen')">Achsen & Layout</button>
            <button class="tab-button" onclick="showTab('mehrere')">Mehrere Plots</button>
            <button class="tab-button" onclick="showTab('3d')">3D-Plots</button>
        </div>

        <div class="content">
            <!-- Grundlagen Tab -->
            <div id="grundlagen" class="tab-content active">
                <h2>Plot-Grundlagen</h2>
                <p>Die grundlegende Funktion zum Plotten in MATLAB ist <code>plot()</code>.</p>

                <div class="interactive-section">
                    <h3>Interaktiver Plot-Generator</h3>
                    <div class="controls">
                        <div class="control-group">
                            <label>Funktion:</label>
                            <select id="plotFunc">
                                <option value="sin">sin(x)</option>
                                <option value="cos">cos(x)</option>
                                <option value="tan">tan(x)</option>
                                <option value="exp">exp(x)</option>
                                <option value="log">log(x)</option>
                                <option value="sqrt">sqrt(x)</option>
                                <option value="x2">x²</option>
                                <option value="x3">x³</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>X-Bereich:</label>
                            <input type="number" id="xMin" value="0" step="0.5"> bis
                            <input type="number" id="xMax" value="10" step="0.5">
                        </div>
                        <div class="control-group">
                            <label>
                                <input type="checkbox" id="useCustomColor">
                                Linienfarbe:
                            </label>
                            <input type="color" id="lineColor" value="#1abc9c">
                        </div>
                        <div class="control-group">
                            <label>Linienstil:</label>
                            <select id="lineStyle">
                                <option value="none">Standard (MATLAB-Default)</option>
                                <option value="solid">Durchgezogen (-)</option>
                                <option value="dashed">Gestrichelt (--)</option>
                                <option value="dotted">Gepunktet (:)</option>
                                <option value="dashdot">Strich-Punkt (-·)</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Marker:</label>
                            <select id="markerStyle">
                                <option value="none">Keine</option>
                                <option value="o">Kreis (o)</option>
                                <option value="x">X-Kreuz (x)</option>
                                <option value="plus">Plus (+)</option>
                                <option value="star">Stern (*)</option>
                                <option value="square">Quadrat (s)</option>
                                <option value="diamond">Diamant (d)</option>
                                <option value="triangle">Dreieck (^)</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Schrittweite:</label>
                            <input type="number" id="stepSize" value="0.1" step="0.01" min="0.01">
                        </div>
                        <button onclick="updateBasicPlot()">Plot aktualisieren</button>
                    </div>
                    <div class="chart-container">
                        <canvas id="basicPlot"></canvas>
                    </div>
                    <div class="code-block" id="basicPlotCode"></div>
                </div>

                <div class="info-box">
                    <strong>Grundlegende Syntax:</strong><br>
                    <code>plot(x, y)</code> - Plottet y gegen x<br>
                    <code>plot(y)</code> - Plottet y gegen Index<br>
                    <code>plot(x, y, 'r--')</code> - Mit Formatierung (rot, gestrichelt)<br>
                    <code>plot(x, y, '-o')</code> - Linie mit Kreismarkern<br>
                    <code>plot(x, y, 'o')</code> - Nur Marker ohne Linie<br><br>
                    <strong>Farben:</strong> 'r' (rot), 'g' (grün), 'b' (blau), 'k' (schwarz), 'c' (cyan), 'm' (magenta), 'y' (gelb)<br>
                    <strong>Linien:</strong> '-' (durchgezogen), '--' (gestrichelt), ':' (gepunktet), '-.' (strich-punkt)<br>
                    <strong>Marker:</strong> 'o' (Kreis), 'x' (X), '+' (Plus), '*' (Stern), 's' (Quadrat), 'd' (Diamant), '^' (Dreieck)
                </div>
            </div>

            <!-- Plot-Typen Tab -->
            <div id="plottypen" class="tab-content">
                <h2>Verschiedene Plot-Typen</h2>
                <p>MATLAB bietet viele spezialisierte Plot-Funktionen für verschiedene Datenvisualisierungen.</p>

                <div class="plot-types-grid">
                    <div class="plot-card" onclick="showPlotType('line')">
                        <h3>plot() - Linienplot</h3>
                        <div class="mini-chart">
                            <canvas id="miniLine"></canvas>
                        </div>
                        <div class="code-block">plot(x, y)</div>
                    </div>

                    <div class="plot-card" onclick="showPlotType('scatter')">
                        <h3>scatter() - Streudiagramm</h3>
                        <div class="mini-chart">
                            <canvas id="miniScatter"></canvas>
                        </div>
                        <div class="code-block">scatter(x, y)</div>
                    </div>

                    <div class="plot-card" onclick="showPlotType('bar')">
                        <h3>bar() - Balkendiagramm</h3>
                        <div class="mini-chart">
                            <canvas id="miniBar"></canvas>
                        </div>
                        <div class="code-block">bar(y)</div>
                    </div>

                    <div class="plot-card" onclick="showPlotType('area')">
                        <h3>area() - Flächendiagramm</h3>
                        <div class="mini-chart">
                            <canvas id="miniArea"></canvas>
                        </div>
                        <div class="code-block">area(x, y)</div>
                    </div>

                    <div class="plot-card" onclick="showPlotType('stairs')">
                        <h3>stairs() - Treppendiagramm</h3>
                        <div class="mini-chart">
                            <canvas id="miniStairs"></canvas>
                        </div>
                        <div class="code-block">stairs(x, y)</div>
                    </div>

                    <div class="plot-card" onclick="showPlotType('histogram')">
                        <h3>histogram() - Histogramm</h3>
                        <div class="mini-chart">
                            <canvas id="miniHist"></canvas>
                        </div>
                        <div class="code-block">histogram(data)</div>
                    </div>
                </div>

                <div class="interactive-section">
                    <h3>Interaktive Plot-Typ Demonstration</h3>
                    <p>Geben Sie Ihre eigenen Daten ein und wählen Sie einen Plot-Typ:</p>
                    <div class="controls">
                        <div class="control-group">
                            <label>X-Werte (kommagetrennt):</label>
                            <input type="text" id="customX" value="0, 1, 2, 3, 4, 5, 6, 7, 8, 9" style="min-width: 300px;">
                        </div>
                        <div class="control-group">
                            <label>Y-Werte (kommagetrennt):</label>
                            <input type="text" id="customY" value="0, 3, 1, 4, 2, 5, 3, 6, 4, 7" style="min-width: 300px;">
                        </div>
                        <div class="control-group">
                            <label>Plot-Typ:</label>
                            <select id="customPlotType">
                                <option value="line">Line Plot</option>
                                <option value="scatter">Scatter Plot</option>
                                <option value="bar">Bar Chart</option>
                                <option value="area">Area Plot</option>
                                <option value="stairs">Stairs Plot</option>
                            </select>
                        </div>
                        <button onclick="updateCustomPlot()">Plot aktualisieren</button>
                    </div>
                    <div class="chart-container">
                        <canvas id="typePlot"></canvas>
                    </div>
                    <div class="code-block" id="typePlotCode"></div>
                </div>
            </div>

            <!-- Achsen & Layout Tab -->
            <div id="achsen" class="tab-content">
                <h2>Achsen-Konfiguration und Layout</h2>
                <p>MATLAB bietet umfangreiche Möglichkeiten zur Anpassung von Achsen und Layout.</p>

                <div class="interactive-section">
                    <h3>Achsen-Eigenschaften</h3>
                    <div class="axes-config">
                        <div class="control-group">
                            <label>Titel:</label>
                            <input type="text" id="plotTitle" value="Beispiel-Plot">
                        </div>
                        <div class="control-group">
                            <label>X-Label:</label>
                            <input type="text" id="xLabel" value="Zeit [s]">
                        </div>
                        <div class="control-group">
                            <label>Y-Label:</label>
                            <input type="text" id="yLabel" value="Amplitude">
                        </div>
                        <div class="control-group">
                            <label>Gitter:</label>
                            <select id="gridOption">
                                <option value="both">Beide</option>
                                <option value="x">Nur X</option>
                                <option value="y">Nur Y</option>
                                <option value="none">Aus</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Legende:</label>
                            <input type="text" id="legendText" value="Messdaten">
                        </div>
                        <div class="control-group">
                            <label>Y-Achse Skalierung:</label>
                            <select id="yScale">
                                <option value="linear">Linear</option>
                                <option value="logarithmic">Logarithmisch</option>
                            </select>
                        </div>
                    </div>
                    <button onclick="updateAxesPlot()">Aktualisieren</button>
                    <div class="chart-container">
                        <canvas id="axesPlot"></canvas>
                    </div>
                    <div class="code-block" id="axesCode"></div>
                </div>

                <div class="info-box">
                    <strong>Wichtige Achsen-Funktionen:</strong><br>
                    <code>title('Titel')</code> - Setzt den Titel<br>
                    <code>xlabel('X-Achse')</code> - Beschriftet X-Achse<br>
                    <code>ylabel('Y-Achse')</code> - Beschriftet Y-Achse<br>
                    <code>legend('Daten')</code> - Fügt Legende hinzu<br>
                    <code>grid on</code> - Aktiviert Gitter<br>
                    <code>xlim([min, max])</code> - Setzt X-Achsen-Grenzen<br>
                    <code>ylim([min, max])</code> - Setzt Y-Achsen-Grenzen
                </div>
            </div>

            <!-- Mehrere Plots Tab -->
            <div id="mehrere" class="tab-content">
                <h2>Mehrere Plots</h2>
                <p>MATLAB ermöglicht das Anzeigen mehrerer Plots in einer Figure mit <code>subplot()</code> oder <code>hold on</code>.</p>

                <h3>hold on - Mehrere Linien in einem Plot</h3>
                <div class="code-block"><span class="function">plot</span>(x, sin(x))
<span class="function">hold on</span>  <span class="comment">% Nächster plot() überschreibt nicht</span>
<span class="function">plot</span>(x, cos(x))
<span class="function">plot</span>(x, tan(x))
<span class="function">hold off</span></div>

                <div class="interactive-section">
                    <h3>Hold On Demo</h3>
                    <div class="chart-container">
                        <canvas id="holdPlot"></canvas>
                    </div>
                </div>

                <h3>subplot() - Mehrere Achsensysteme</h3>
                <div class="code-block"><span class="function">subplot</span>(2, 2, 1)  <span class="comment">% 2 Zeilen, 2 Spalten, Position 1</span>
<span class="function">plot</span>(x, sin(x))
<span class="function">title</span>(<span class="string">'Sin'</span>)

<span class="function">subplot</span>(2, 2, 2)  <span class="comment">% Position 2</span>
<span class="function">plot</span>(x, cos(x))
<span class="function">title</span>(<span class="string">'Cos'</span>)

<span class="function">subplot</span>(2, 2, [3, 4])  <span class="comment">% Kombiniert Position 3 und 4</span>
<span class="function">plot</span>(x, exp(x))
<span class="function">title</span>(<span class="string">'Exp'</span>)</div>

                <div class="interactive-section">
                    <h3>Subplot-Simulation</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div class="chart-container" style="height: 250px;">
                            <canvas id="subplot1"></canvas>
                        </div>
                        <div class="chart-container" style="height: 250px;">
                            <canvas id="subplot2"></canvas>
                        </div>
                        <div class="chart-container" style="height: 250px; grid-column: 1 / -1;">
                            <canvas id="subplot3"></canvas>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <strong>Subplot-Indexierung:</strong><br>
                    Die Position wird zeilenweise gezählt (nicht spaltenweise wie bei Matrizen!):<br>
                    <code>subplot(2, 3, 1)</code> bis <code>subplot(2, 3, 6)</code> für 2×3 Layout<br>
                    Position 1-3 in erster Zeile, 4-6 in zweiter Zeile
                </div>
            </div>

            <!-- 3D-Plots Tab -->
            <div id="3d" class="tab-content">
                <h2>3D-Plots</h2>
                <p>MATLAB bietet verschiedene Funktionen für 3D-Visualisierungen.</p>

                <div class="code-block"><span class="comment">% 3D-Linienplot</span>
t = 0:pi/50:10*pi;
<span class="function">plot3</span>(sin(t), cos(t), t)

<span class="comment">% 3D-Oberflächenplot</span>
[X, Y] = meshgrid(-5:0.5:5);
Z = sin(sqrt(X.^2 + Y.^2));
<span class="function">surf</span>(X, Y, Z)

<span class="comment">% 3D-Mesh</span>
<span class="function">mesh</span>(X, Y, Z)

<span class="comment">% Ansicht ändern</span>
<span class="function">view</span>(45, 30)  <span class="comment">% Azimut 45°, Elevation 30°</span></div>

                <div class="info-box">
                    <strong>Wichtige 3D-Funktionen:</strong><br>
                    <code>plot3(x, y, z)</code> - 3D-Linienplot<br>
                    <code>surf(X, Y, Z)</code> - Oberflächenplot mit Farben<br>
                    <code>mesh(X, Y, Z)</code> - Drahtgitterplot<br>
                    <code>contour(Z)</code> - Konturplot (Höhenlinien)<br>
                    <code>view(azimut, elevation)</code> - Blickwinkel ändern<br>
                    <code>[X,Y] = meshgrid(x,y)</code> - Erstellt Koordinatengitter
                </div>

                <div class="interactive-section">
                    <h3>3D-Funktionsvisualisierung</h3>
                    <p>Wählen Sie eine 3D-Funktion zur Visualisierung (als Heatmap-Projektion):</p>
                    <div class="controls">
                        <div class="control-group">
                            <label>Funktion:</label>
                            <select id="func3D" onchange="update3DPlot()">
                                <option value="sinc">sinc(r) - Mexican Hat</option>
                                <option value="peaks">Peaks Function</option>
                                <option value="saddle">Sattelfläche (x² - y²)</option>
                                <option value="wave">Wellenfunktion</option>
                                <option value="cone">Kegel</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Auflösung:</label>
                            <select id="resolution3D" onchange="update3DPlot()">
                                <option value="20">Niedrig (20×20)</option>
                                <option value="30" selected>Mittel (30×30)</option>
                                <option value="40">Hoch (40×40)</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="plot3D"></canvas>
                    </div>
                    <div class="code-block" id="code3D"></div>
                </div>

                <div class="interactive-section">
                    <h3>3D-Helix (plot3)</h3>
                    <p>Parametrische 3D-Kurve: Helix (Spirale)</p>
                    <div class="controls">
                        <div class="control-group">
                            <label>Windungen:</label>
                            <input type="range" id="helixTurns" min="1" max="10" value="3" oninput="updateHelix()">
                            <span id="helixTurnsValue">3</span>
                        </div>
                        <div class="control-group">
                            <label>Radius:</label>
                            <input type="range" id="helixRadius" min="1" max="5" value="2" step="0.5" oninput="updateHelix()">
                            <span id="helixRadiusValue">2</span>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <h4 style="text-align: center; margin: 10px 0;">XY-Projektion (von oben)</h4>
                            <div class="chart-container" style="height: 300px;">
                                <canvas id="helixXY"></canvas>
                            </div>
                        </div>
                        <div>
                            <h4 style="text-align: center; margin: 10px 0;">XZ-Projektion (von vorne)</h4>
                            <div class="chart-container" style="height: 300px;">
                                <canvas id="helixXZ"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="code-block" id="helixCode"></div>
                </div>

                <h3>Export von Plots</h3>
                <div class="code-block"><span class="comment">% Als Figure speichern</span>
<span class="function">savefig</span>(<span class="string">'meinPlot.fig'</span>)

<span class="comment">% Als PNG exportieren (ab R2020a)</span>
<span class="function">exportgraphics</span>(gcf, <span class="string">'plot.png'</span>, <span class="string">'Resolution'</span>, 300)

<span class="comment">% Als PDF exportieren</span>
<span class="function">exportgraphics</span>(gcf, <span class="string">'plot.pdf'</span>, <span class="string">'ContentType'</span>, <span class="string">'vector'</span>)

<span class="comment">% Alte Methode (vor R2020a)</span>
<span class="function">print</span>(<span class="string">'plot'</span>, <span class="string">'-dpng'</span>, <span class="string">'-r300'</span>)  <span class="comment">% PNG mit 300 dpi</span>
<span class="function">print</span>(<span class="string">'plot'</span>, <span class="string">'-dpdf'</span>)  <span class="comment">% PDF</span></div>
            </div>
        </div>
    </div>

    <script>
        let basicChart, typeChart, axesChart, holdChart;
        let subplot1Chart, subplot2Chart, subplot3Chart;
        let plot3DChart, helixXYChart, helixXZChart;

        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-button');

            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function generateData(func, xMin, xMax, points = 100) {
            const x = [];
            const y = [];
            const step = (xMax - xMin) / points;

            for (let i = 0; i <= points; i++) {
                const xVal = xMin + i * step;
                x.push(xVal);

                switch(func) {
                    case 'sin': y.push(Math.sin(xVal)); break;
                    case 'cos': y.push(Math.cos(xVal)); break;
                    case 'tan': y.push(Math.tan(xVal)); break;
                    case 'exp': y.push(Math.exp(xVal)); break;
                    case 'log': y.push(Math.log(xVal)); break;
                    case 'sqrt': y.push(Math.sqrt(Math.abs(xVal))); break;
                    case 'x2': y.push(xVal * xVal); break;
                    case 'x3': y.push(xVal * xVal * xVal); break;
                }
            }

            return { x, y };
        }

        function updateBasicPlot() {
            const func = document.getElementById('plotFunc').value;
            const xMin = parseFloat(document.getElementById('xMin').value);
            const xMax = parseFloat(document.getElementById('xMax').value);
            const stepSize = parseFloat(document.getElementById('stepSize').value);
            const useCustomColor = document.getElementById('useCustomColor').checked;
            const color = document.getElementById('lineColor').value;
            const style = document.getElementById('lineStyle').value;
            const marker = document.getElementById('markerStyle').value;

            // Berechne Anzahl der Punkte basierend auf Schrittweite
            const numPoints = Math.floor((xMax - xMin) / stepSize) + 1;
            const data = generateData(func, xMin, xMax, numPoints - 1);

            const borderDash = {
                'none': [],
                'solid': [],
                'dashed': [10, 5],
                'dotted': [2, 3],
                'dashdot': [10, 5, 2, 5]
            }[style];

            // Chart.js Marker-Mapping
            const markerStyleMap = {
                'none': 'circle',
                'o': 'circle',
                'x': 'cross',
                'plus': 'crossRot',
                'star': 'star',
                'square': 'rect',
                'diamond': 'rectRot',
                'triangle': 'triangle'
            };

            const pointRadius = marker !== 'none' ? 4 : 0;
            const showLine = style !== 'none' || marker === 'none';

            if (basicChart) basicChart.destroy();

            basicChart = new Chart(document.getElementById('basicPlot'), {
                type: 'line',
                data: {
                    labels: data.x.map(v => v.toFixed(2)),
                    datasets: [{
                        label: func + '(x)',
                        data: data.y,
                        borderColor: useCustomColor ? color : '#1abc9c',
                        borderWidth: 2,
                        borderDash: borderDash,
                        fill: false,
                        pointRadius: pointRadius,
                        pointStyle: markerStyleMap[marker],
                        pointBackgroundColor: useCustomColor ? color : '#1abc9c',
                        showLine: showLine
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true }
                    },
                    scales: {
                        x: { title: { display: true, text: 'x' } },
                        y: { title: { display: true, text: 'y' } }
                    }
                }
            });

            const lineStyleMap = {
                'solid': '-',
                'dashed': '--',
                'dotted': ':',
                'dashdot': '-.'
            };

            const markerMap = {
                'o': 'o',
                'x': 'x',
                'plus': '+',
                'star': '*',
                'square': 's',
                'diamond': 'd',
                'triangle': '^'
            };

            // Konvertiere HEX zu RGB für MATLAB
            const hexToRgb = (hex) => {
                const r = parseInt(hex.slice(1, 3), 16) / 255;
                const g = parseInt(hex.slice(3, 5), 16) / 255;
                const b = parseInt(hex.slice(5, 7), 16) / 255;
                return `[${r.toFixed(2)}, ${g.toFixed(2)}, ${b.toFixed(2)}]`;
            };

            // Generiere MATLAB-Code
            let plotCode = `x = ${xMin}:${stepSize}:${xMax};\ny = ${func}(x);\n`;

            // Bestimme plot()-Argumente
            let plotArgs = 'x, y';
            let formatString = '';

            // Baue Format-String (Linienstil + Marker)
            if (style !== 'none' || marker !== 'none') {
                if (style !== 'none') {
                    formatString += lineStyleMap[style];
                }
                if (marker !== 'none') {
                    formatString += markerMap[marker];
                }
                plotArgs += `, '${formatString}'`;
            }

            // Füge Farbe hinzu, wenn Checkbox aktiviert
            if (useCustomColor) {
                plotArgs += `, 'Color', ${hexToRgb(color)}`;
            }

            plotCode += `plot(${plotArgs})`;

            document.getElementById('basicPlotCode').textContent = plotCode;
        }

        function initMiniCharts() {
            const x = Array.from({length: 20}, (_, i) => i);

            // Line plot
            new Chart(document.getElementById('miniLine'), {
                type: 'line',
                data: {
                    labels: x,
                    datasets: [{
                        data: x.map(v => Math.sin(v / 3)),
                        borderColor: '#1abc9c',
                        borderWidth: 2,
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });

            // Scatter
            new Chart(document.getElementById('miniScatter'), {
                type: 'scatter',
                data: {
                    datasets: [{
                        data: x.map(v => ({ x: v, y: Math.random() * 10 })),
                        backgroundColor: '#e74c3c',
                        pointRadius: 4
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });

            // Bar
            new Chart(document.getElementById('miniBar'), {
                type: 'bar',
                data: {
                    labels: x.slice(0, 10),
                    datasets: [{
                        data: x.slice(0, 10).map(v => Math.random() * 10),
                        backgroundColor: '#3498db'
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });

            // Area
            new Chart(document.getElementById('miniArea'), {
                type: 'line',
                data: {
                    labels: x,
                    datasets: [{
                        data: x.map(v => Math.sin(v / 3) + 5),
                        borderColor: '#9b59b6',
                        backgroundColor: 'rgba(155, 89, 182, 0.3)',
                        fill: true,
                        pointRadius: 0
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });

            // Stairs
            new Chart(document.getElementById('miniStairs'), {
                type: 'line',
                data: {
                    labels: x,
                    datasets: [{
                        data: x.map(v => Math.floor(v / 3)),
                        borderColor: '#e67e22',
                        stepped: true,
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });

            // Histogram
            new Chart(document.getElementById('miniHist'), {
                type: 'bar',
                data: {
                    labels: ['0-2', '2-4', '4-6', '6-8', '8-10'],
                    datasets: [{
                        data: [5, 12, 8, 6, 3],
                        backgroundColor: '#16a085'
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });
        }

        function showPlotType(type) {
            const x = Array.from({length: 50}, (_, i) => i / 5);
            let config;

            switch(type) {
                case 'line':
                    config = {
                        type: 'line',
                        data: {
                            labels: x,
                            datasets: [{
                                label: 'sin(x)',
                                data: x.map(v => Math.sin(v)),
                                borderColor: '#1abc9c',
                                fill: false,
                                pointRadius: 0
                            }]
                        }
                    };
                    document.getElementById('typePlotCode').textContent = 'plot(x, sin(x))';
                    break;
                case 'scatter':
                    config = {
                        type: 'scatter',
                        data: {
                            datasets: [{
                                label: 'Zufallsdaten',
                                data: x.map(v => ({ x: v, y: Math.random() * 10 })),
                                backgroundColor: '#e74c3c'
                            }]
                        }
                    };
                    document.getElementById('typePlotCode').textContent = 'scatter(x, y)';
                    break;
                case 'bar':
                    config = {
                        type: 'bar',
                        data: {
                            labels: x.slice(0, 10).map(v => v.toFixed(1)),
                            datasets: [{
                                label: 'Werte',
                                data: x.slice(0, 10).map(v => Math.random() * 10),
                                backgroundColor: '#3498db'
                            }]
                        }
                    };
                    document.getElementById('typePlotCode').textContent = 'bar(y)';
                    break;
                case 'area':
                    config = {
                        type: 'line',
                        data: {
                            labels: x,
                            datasets: [{
                                label: 'Fläche',
                                data: x.map(v => Math.sin(v) + 5),
                                borderColor: '#9b59b6',
                                backgroundColor: 'rgba(155, 89, 182, 0.3)',
                                fill: true,
                                pointRadius: 0
                            }]
                        }
                    };
                    document.getElementById('typePlotCode').textContent = 'area(x, y)';
                    break;
                case 'stairs':
                    config = {
                        type: 'line',
                        data: {
                            labels: x,
                            datasets: [{
                                label: 'Treppe',
                                data: x.map(v => Math.floor(v)),
                                borderColor: '#e67e22',
                                stepped: true,
                                fill: false,
                                pointRadius: 0
                            }]
                        }
                    };
                    document.getElementById('typePlotCode').textContent = 'stairs(x, y)';
                    break;
                case 'histogram':
                    config = {
                        type: 'bar',
                        data: {
                            labels: ['0-2', '2-4', '4-6', '6-8', '8-10'],
                            datasets: [{
                                label: 'Häufigkeit',
                                data: [15, 25, 18, 12, 8],
                                backgroundColor: '#16a085'
                            }]
                        }
                    };
                    document.getElementById('typePlotCode').textContent = 'histogram(data)';
                    break;
            }

            if (typeChart) typeChart.destroy();
            typeChart = new Chart(document.getElementById('typePlot'), {
                ...config,
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function updateAxesPlot() {
            const title = document.getElementById('plotTitle').value;
            const xLabel = document.getElementById('xLabel').value;
            const yLabel = document.getElementById('yLabel').value;
            const grid = document.getElementById('gridOption').value;
            const legend = document.getElementById('legendText').value;
            const yScale = document.getElementById('yScale').value;

            const data = generateData('sin', 0, 10);

            if (axesChart) axesChart.destroy();

            axesChart = new Chart(document.getElementById('axesPlot'), {
                type: 'line',
                data: {
                    labels: data.x.map(v => v.toFixed(2)),
                    datasets: [{
                        label: legend,
                        data: data.y,
                        borderColor: '#1abc9c',
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: title, font: { size: 16 } },
                        legend: { display: true }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: xLabel },
                            grid: { display: grid === 'both' || grid === 'x' }
                        },
                        y: {
                            type: yScale,
                            title: { display: true, text: yLabel },
                            grid: { display: grid === 'both' || grid === 'y' }
                        }
                    }
                }
            });

            let gridCode = '';
            if (grid === 'both') {
                gridCode = `grid on\n`;
            } else if (grid === 'x') {
                gridCode = `ax = gca;\nax.XGrid = 'on';\nax.YGrid = 'off';\n`;
            } else if (grid === 'y') {
                gridCode = `ax = gca;\nax.XGrid = 'off';\nax.YGrid = 'on';\n`;
            }

            document.getElementById('axesCode').textContent =
                `plot(x, y)\n` +
                `title('${title}')\n` +
                `xlabel('${xLabel}')\n` +
                `ylabel('${yLabel}')\n` +
                `legend('${legend}')\n` +
                gridCode +
                (yScale === 'logarithmic' ? `set(gca, 'YScale', 'log')\n` : '');
        }

        function initHoldPlot() {
            const x = Array.from({length: 100}, (_, i) => i / 10);

            holdChart = new Chart(document.getElementById('holdPlot'), {
                type: 'line',
                data: {
                    labels: x,
                    datasets: [
                        {
                            label: 'sin(x)',
                            data: x.map(v => Math.sin(v)),
                            borderColor: '#e74c3c',
                            fill: false,
                            pointRadius: 0
                        },
                        {
                            label: 'cos(x)',
                            data: x.map(v => Math.cos(v)),
                            borderColor: '#3498db',
                            fill: false,
                            pointRadius: 0
                        },
                        {
                            label: 'sin(x) * cos(x)',
                            data: x.map(v => Math.sin(v) * Math.cos(v)),
                            borderColor: '#2ecc71',
                            fill: false,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        function initSubplots() {
            const x = Array.from({length: 50}, (_, i) => i / 5);

            subplot1Chart = new Chart(document.getElementById('subplot1'), {
                type: 'line',
                data: {
                    labels: x,
                    datasets: [{
                        label: 'sin(x)',
                        data: x.map(v => Math.sin(v)),
                        borderColor: '#e74c3c',
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { title: { display: true, text: 'Sin' } }
                }
            });

            subplot2Chart = new Chart(document.getElementById('subplot2'), {
                type: 'line',
                data: {
                    labels: x,
                    datasets: [{
                        label: 'cos(x)',
                        data: x.map(v => Math.cos(v)),
                        borderColor: '#3498db',
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { title: { display: true, text: 'Cos' } }
                }
            });

            subplot3Chart = new Chart(document.getElementById('subplot3'), {
                type: 'line',
                data: {
                    labels: x,
                    datasets: [{
                        label: 'x²',
                        data: x.map(v => v * v / 10),
                        borderColor: '#2ecc71',
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { title: { display: true, text: 'Quadratfunktion' } }
                }
            });
        }

        // 3D-Oberflächenplot als Heatmap
        function update3DPlot() {
            const func = document.getElementById('func3D').value;
            const res = parseInt(document.getElementById('resolution3D').value);

            // Erstelle Meshgrid
            const range = 5;
            const step = (2 * range) / (res - 1);
            const data = [];
            let funcStr = '';

            for (let i = 0; i < res; i++) {
                const y = -range + i * step;
                for (let j = 0; j < res; j++) {
                    const x = -range + j * step;
                    let z = 0;

                    switch(func) {
                        case 'sinc':
                            const r = Math.sqrt(x*x + y*y) + 0.0001;
                            z = Math.sin(r) / r;
                            funcStr = '[X, Y] = meshgrid(-5:0.25:5);\nR = sqrt(X.^2 + Y.^2) + eps;\nZ = sin(R) ./ R;\nsurf(X, Y, Z)';
                            break;
                        case 'peaks':
                            z = 3*(1-x)^2 * Math.exp(-x^2 - (y+1)^2)
                                - 10*(x/5 - x^3 - y^5) * Math.exp(-x^2 - y^2)
                                - 1/3 * Math.exp(-(x+1)^2 - y^2);
                            funcStr = 'Z = peaks(30);\nsurf(Z)';
                            break;
                        case 'saddle':
                            z = x*x - y*y;
                            funcStr = '[X, Y] = meshgrid(-5:0.25:5);\nZ = X.^2 - Y.^2;\nsurf(X, Y, Z)';
                            break;
                        case 'wave':
                            z = Math.sin(x) * Math.cos(y);
                            funcStr = '[X, Y] = meshgrid(-5:0.25:5);\nZ = sin(X) .* cos(Y);\nsurf(X, Y, Z)';
                            break;
                        case 'cone':
                            z = -Math.sqrt(x*x + y*y);
                            funcStr = '[X, Y] = meshgrid(-5:0.25:5);\nZ = -sqrt(X.^2 + Y.^2);\nsurf(X, Y, Z)';
                            break;
                    }

                    data.push({
                        x: j,
                        y: i,
                        v: z
                    });
                }
            }

            // Erstelle Farbskala basierend auf Z-Werten
            const zValues = data.map(d => d.v);
            const minZ = Math.min(...zValues);
            const maxZ = Math.max(...zValues);

            // Matrix-Daten für Heatmap
            const matrixData = [];
            for (let i = 0; i < res; i++) {
                const row = [];
                for (let j = 0; j < res; j++) {
                    row.push(data[i * res + j].v);
                }
                matrixData.push(row);
            }

            if (plot3DChart) plot3DChart.destroy();

            // Verwende Matrix-Visualisierung (Bubble Chart für Heatmap-Effekt)
            const bubbleData = data.map(d => ({
                x: d.x,
                y: d.y,
                r: 8,
                z: d.v
            }));

            // Normalisiere Farben
            const normalizeColor = (val) => {
                const norm = (val - minZ) / (maxZ - minZ);
                const hue = (1 - norm) * 240; // Blau (240) bis Rot (0)
                return `hsl(${hue}, 70%, 50%)`;
            };

            plot3DChart = new Chart(document.getElementById('plot3D'), {
                type: 'bubble',
                data: {
                    datasets: [{
                        label: 'Z-Werte',
                        data: bubbleData,
                        backgroundColor: bubbleData.map(d => normalizeColor(d.z)),
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'Heatmap-Projektion der 3D-Oberfläche' },
                        tooltip: {
                            callbacks: {
                                label: (context) => {
                                    const z = context.raw.z;
                                    return `Z = ${z.toFixed(3)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'X' },
                            min: 0,
                            max: res - 1
                        },
                        y: {
                            title: { display: true, text: 'Y' },
                            min: 0,
                            max: res - 1
                        }
                    }
                }
            });

            document.getElementById('code3D').textContent = funcStr;
        }

        // 3D-Helix Visualisierung
        function updateHelix() {
            const turns = parseFloat(document.getElementById('helixTurns').value);
            const radius = parseFloat(document.getElementById('helixRadius').value);

            document.getElementById('helixTurnsValue').textContent = turns;
            document.getElementById('helixRadiusValue').textContent = radius;

            // Generiere Helix-Punkte
            const points = 200;
            const t = [];
            const x = [];
            const y = [];
            const z = [];

            for (let i = 0; i < points; i++) {
                const tVal = (i / points) * turns * 2 * Math.PI;
                t.push(tVal);
                x.push(radius * Math.cos(tVal));
                y.push(radius * Math.sin(tVal));
                z.push(tVal * 2);
            }

            // XY-Projektion (von oben)
            if (helixXYChart) helixXYChart.destroy();
            helixXYChart = new Chart(document.getElementById('helixXY'), {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'XY-Projektion',
                        data: x.map((xVal, i) => ({ x: xVal, y: y[i] })),
                        backgroundColor: x.map((_, i) => {
                            const hue = (i / points) * 240;
                            return `hsl(${hue}, 70%, 50%)`;
                        }),
                        pointRadius: 3,
                        showLine: true,
                        borderColor: '#1abc9c',
                        borderWidth: 1,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: {
                            title: { display: true, text: 'X' },
                            min: -radius - 1,
                            max: radius + 1
                        },
                        y: {
                            title: { display: true, text: 'Y' },
                            min: -radius - 1,
                            max: radius + 1
                        }
                    }
                }
            });

            // XZ-Projektion (von vorne)
            if (helixXZChart) helixXZChart.destroy();
            helixXZChart = new Chart(document.getElementById('helixXZ'), {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'XZ-Projektion',
                        data: x.map((xVal, i) => ({ x: xVal, y: z[i] })),
                        backgroundColor: x.map((_, i) => {
                            const hue = (i / points) * 240;
                            return `hsl(${hue}, 70%, 50%)`;
                        }),
                        pointRadius: 3,
                        showLine: true,
                        borderColor: '#e74c3c',
                        borderWidth: 1,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: {
                            title: { display: true, text: 'X' },
                            min: -radius - 1,
                            max: radius + 1
                        },
                        y: {
                            title: { display: true, text: 'Z (Höhe)' },
                            min: 0,
                            max: turns * 2 * Math.PI * 2
                        }
                    }
                }
            });

            document.getElementById('helixCode').textContent =
                `t = 0:pi/50:${turns}*2*pi;\n` +
                `x = ${radius} * cos(t);\n` +
                `y = ${radius} * sin(t);\n` +
                `z = t * 2;\n` +
                `plot3(x, y, z)\n` +
                `xlabel('X'); ylabel('Y'); zlabel('Z')\n` +
                `grid on`;
        }

        // Custom Plot mit Benutzereingaben
        function updateCustomPlot() {
            const xInput = document.getElementById('customX').value;
            const yInput = document.getElementById('customY').value;
            const plotType = document.getElementById('customPlotType').value;

            // Parse Eingaben
            const xData = xInput.split(',').map(v => parseFloat(v.trim())).filter(v => !isNaN(v));
            const yData = yInput.split(',').map(v => parseFloat(v.trim())).filter(v => !isNaN(v));

            // Validierung
            if (xData.length === 0 || yData.length === 0) {
                alert('Bitte geben Sie gültige Zahlen ein!');
                return;
            }

            if (xData.length !== yData.length) {
                alert('X und Y müssen die gleiche Anzahl von Werten haben!');
                return;
            }

            let config;
            let code = '';

            switch(plotType) {
                case 'line':
                    config = {
                        type: 'line',
                        data: {
                            labels: xData,
                            datasets: [{
                                label: 'y(x)',
                                data: yData,
                                borderColor: '#1abc9c',
                                fill: false,
                                pointRadius: 3
                            }]
                        }
                    };
                    code = `x = [${xData.join(', ')}];\ny = [${yData.join(', ')}];\nplot(x, y)`;
                    break;

                case 'scatter':
                    config = {
                        type: 'scatter',
                        data: {
                            datasets: [{
                                label: 'Datenpunkte',
                                data: xData.map((x, i) => ({ x: x, y: yData[i] })),
                                backgroundColor: '#e74c3c',
                                pointRadius: 6
                            }]
                        },
                        options: {
                            scales: {
                                x: { type: 'linear', position: 'bottom' }
                            }
                        }
                    };
                    code = `x = [${xData.join(', ')}];\ny = [${yData.join(', ')}];\nscatter(x, y)`;
                    break;

                case 'bar':
                    config = {
                        type: 'bar',
                        data: {
                            labels: xData.map(v => v.toString()),
                            datasets: [{
                                label: 'Werte',
                                data: yData,
                                backgroundColor: '#3498db'
                            }]
                        }
                    };
                    code = `x = [${xData.join(', ')}];\ny = [${yData.join(', ')}];\nbar(x, y)`;
                    break;

                case 'area':
                    config = {
                        type: 'line',
                        data: {
                            labels: xData,
                            datasets: [{
                                label: 'Fläche',
                                data: yData,
                                borderColor: '#9b59b6',
                                backgroundColor: 'rgba(155, 89, 182, 0.3)',
                                fill: true,
                                pointRadius: 0
                            }]
                        }
                    };
                    code = `x = [${xData.join(', ')}];\ny = [${yData.join(', ')}];\narea(x, y)`;
                    break;

                case 'stairs':
                    config = {
                        type: 'line',
                        data: {
                            labels: xData,
                            datasets: [{
                                label: 'Treppe',
                                data: yData,
                                borderColor: '#e67e22',
                                stepped: true,
                                fill: false,
                                pointRadius: 3
                            }]
                        }
                    };
                    code = `x = [${xData.join(', ')}];\ny = [${yData.join(', ')}];\nstairs(x, y)`;
                    break;
            }

            if (typeChart) typeChart.destroy();
            typeChart = new Chart(document.getElementById('typePlot'), {
                ...config,
                options: {
                    ...config.options,
                    responsive: true,
                    maintainAspectRatio: false
                }
            });

            document.getElementById('typePlotCode').textContent = code;
        }

        // Initialisierung
        window.onload = function() {
            updateBasicPlot();
            initMiniCharts();
            updateCustomPlot();
            updateAxesPlot();
            initHoldPlot();
            initSubplots();
            update3DPlot();
            updateHelix();
        };
    </script>
</body>
</html>
